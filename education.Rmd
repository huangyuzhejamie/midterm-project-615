---
title: "midterm_project"
author: "YuzheHuang"
date: "2019/10/18"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

1.Setup
```{r, warning=FALSE }
setwd("C:/Users/huang/Desktop/midterm_project_615")
data<-read.csv("education_gender.csv",header = TRUE)
library(tidyr)
library(stringr)
library(dplyr)
library(ggplot2)
```

2.Data wrangling
```{r,warning=FALSE}
n<-colnames(data)
nn<-n[5:37]
data1<-gather(data,year,value,nn)
data2<-unite(data1,"varname",Series,Series.Code, sep="-",remove = TRUE)
data3<-spread(data2,varname,value)

data3$year<-as.numeric(str_sub(data3$year,2,5))

a<-c("country_name","country_code","year","pre_primary_both","pre_primary_female","primary_female","secondary_both","secondary_female","tertiary_both","tertiary_female")
colnames(data3)<-a

```

2.EDA and Visualization
2.1 Calculate total female education ratio each year
```{r,warning=FALSE}
data4<-data3%>%group_by(year)%>%mutate(total_pre_edu_ratio=(sum(as.numeric(pre_primary_female)))/(sum(as.numeric(pre_primary_both))),total_secondary_ratio=(sum(as.numeric(secondary_female)))/(sum(as.numeric(secondary_both))),total_tertiary_ratio=(sum(as.numeric(tertiary_female)))/(sum(as.numeric(tertiary_both))))
```

2.2 Calculate female education ratio by country each year
```{r,warning=FALSE}
data5<-data4%>%mutate(pre_edu_ratio=as.numeric(pre_primary_female)/as.numeric(pre_primary_both),secondary_ratio=as.numeric(secondary_female)/as.numeric(secondary_both),tertiary_ratio=as.numeric(tertiary_female)/as.numeric(tertiary_both))

```



2.3 Overview of female ratio in pre-primary, secondary and tertiary education between 1986 and 2018.
We can see that more females enrolled in tertiary schools compared with pre-primary and secondary ones after 1995.
```{r,warning=FALSE}
total<-data5[,c(3,11:13)]
totalrev<-gather(total,totaledu,ratio,-year)
ggplot(data=totalrev)+geom_point(mapping=aes(x=year,y=ratio,color=totaledu))+guides(color=guide_legend(title=NULL))+theme(legend.text = element_text(color="azure4", size = 4, face = "bold"))+theme(axis.text.x=element_text(size = 6))+theme(legend.position = 'bottom')
```



2.4 Let's look at female enrollment rates in different education level year by year.
2.41 
```{r,warning=FALSE}
ggplot(data=data5)+geom_point(mapping=aes(x=year,y=pre_edu_ratio,color=data5$country_name))+scale_y_continuous(breaks=seq(0.4, 0.5, 0.01)) +
scale_x_continuous(breaks=seq(1985, 2018, 1))+guides(color=guide_legend(title=NULL))+theme(legend.text = element_text(color="azure4", size = 4, face = "bold"))+theme(axis.text.x=element_text(size = 6))+theme(legend.position = 'bottom')+geom_smooth(mapping = aes(x=year,y=data5$total_pre_edu_ratio),se=FALSE)

ggplot(data=data5)+geom_point(mapping=aes(x=year,y=secondary_ratio,color=data5$country_name))+scale_y_continuous(breaks=seq(0.4, 0.5, 0.01)) +
scale_x_continuous(breaks=seq(1985, 2018, 1))+guides(color=guide_legend(title=NULL))+theme(legend.text = element_text(color="azure4", size = 4, face = "bold"))+theme(axis.text.x=element_text(size = 6))+theme(legend.position = 'bottom')+geom_smooth(mapping = aes(x=year,y=data5$total_secondary_ratio),se=FALSE)

ggplot(data=data5)+geom_point(mapping=aes(x=year,y=tertiary_ratio,color=data5$country_name))+scale_y_continuous(breaks=seq(0.4, 0.5, 0.01)) +
scale_x_continuous(breaks=seq(1985, 2018, 1))+guides(color=guide_legend(title=NULL))+theme(legend.text = element_text(color="azure4", size = 4, face = "bold"))+theme(axis.text.x=element_text(size = 6))+theme(legend.position = 'bottom')+geom_smooth(mapping = aes(x=year,y=data5$total_tertiary_ratio),se=FALSE)
```

```{r,warning=FALSE}

a<-colnames(data5)
aa<-a[14:16]
data5rev<-gather(data5,edulevel,ratio,aa)

ggplot(data=data5rev)+geom_point(mapping=aes(x=year,y=ratio,color=edulevel))+guides(color=guide_legend(title=NULL))+theme(legend.text = element_text(color="azure4", size = 4, face = "bold"))+theme(axis.text.x=element_text(size = 6))+theme(legend.position = 'bottom') +facet_wrap(~ country_name, nrow = 4)


```





Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
